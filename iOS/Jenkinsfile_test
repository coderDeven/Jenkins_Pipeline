pipeline {
    agent { label 'deven' }
    environment {
        AD_TYPE = 0
    }
    stages {
        stage('export_path') {
            steps {
                sh 'python3 iOS/Environment/SetupEnv.py'
            }
        }
        stage('param_parse') {
            steps {
                script {
                    AD_TYPE = sh "python3 iOS/Params/ParamParse.py -adoption ${ad_option}"
                }
            }
        }
        stage('param_check') {
            steps {
                sh "python3 iOS/Params/ParamCheck.py ./ddCommon.json ${game_id} ${push_enable} ${firebase_enable}"
            }
        }
        stage('pod_env_setup') {
            steps {
                echo "设置 pod 环境 --> 未完成，待测试"
            }
        }
        stage('fetch_certificate_info') {
            steps {
                echo "获取证书信息"
                sh "./iOS/AppleCert/FetchCertInfo.sh ${game_id} ${push_enable}"
            }
        }
        stage('aaa') {
            steps {
                echo "good"
            }
        }

        stage('test') {
            steps {
                sh "./iOS/Sdebug.sh"
                echo "${params.game_id}"
                echo "${game_id}"
            }
        }
    }

    post {
        always {
            echo "always execution after stages"
        }
        success {
            echo "pipeline execution success"
        }

        failure {
            echo "pipeline execution failed"
        }

    }
}